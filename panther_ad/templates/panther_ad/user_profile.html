<!DOCTYPE html>
<html lang="en" dir="">

<head>
    {% load staticfiles %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Account Setting</title>
    <link href="https://fonts.googleapis.com/css?family=Nunito:300,400,400i,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'assets/styles/css/themes/lite-purple.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/styles/vendor/perfect-scrollbar.css' %}">
    <link rel="stylesheet" href="{% static 'assets/font-awesome/css/font-awesome.min.css' %}">
    <!-- <link rel="stylesheet" href="{% static 'assets/css/style.css' %}"> -->
    <link rel="stylesheet" href="{% static 'assets/css/myCss.css' %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- <link rel="stylesheet" href="{% static 'assets/css/classic.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/classic.date.css' %}"> -->

</head>

<body class="text-left">
<!-- Pre Loader Strat  -->
{#    <div class='loadscreen' id="preloader">#}
{#        <div class="loader spinner-bubble spinner-bubble-primary">#}
{#        </div>#}
{#    </div>#}
<!-- Pre Loader end  -->
<div class="app-admin-wrap layout-sidebar-large">
    <div class="main-header">
        <div class="logo">
            <a href="{% url 'panther_ad:index' %}">
                <img src="{% static 'assets/images/panther_ad.png' %}" alt="">
            </a>
        </div>

        <div class="menu-toggle">
            <div></div>
            <div></div>
            <div></div>
        </div>
        <div style="margin: auto;">

        </div>

        {# Create Ads Btn #} {# Full Screen toggle #}
        <div class="header-part-right">
            <!-- Full screen toggle -->
            <div style="margin-right: 50px;white-space: nowrap;">
                <a href="#">
                    <button type="button" class="buttonsz" data-toggle="modal" data-target="#topupbalance"><span><b class="text-20 pb-10">&nbsp;&nbsp;&nbsp;&nbsp;+
                                    Top up balance</b>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    </button>
                </a>

            </div>
            <!-- Top Up Balance Modal content -->

            <div style="margin-right: 50px;white-space: nowrap;">
                <a href="{% url 'panther_ad:create_ad' %}">
                    <button type="button" class="buttonsz"><span><b class="text-20 pb-10">&nbsp;&nbsp;&nbsp;&nbsp;+
                                    Create
                                    Ad</b>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    </button>
                </a>
            </div>
            <div style="margin-right: 100px;white-space: nowrap;">
                <a href="{% url 'panther_ad:create_campaign' %}">
                    <button type="button" class="buttonsz"><span><b class="text-20 pb-10">&nbsp;&nbsp;&nbsp;&nbsp;+
                                    Create
                                    Campaign</b>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                    </button>
                </a>

            </div>
            <i class="i-Full-Screen header-icon d-none d-sm-inline-block" data-fullscreen></i>
            <!-- Grid menu Dropdown -->


            <!-- User avatar dropdown -->
            <div class="dropdown">
                <div class="user col align-self-end">
                    <img src="{% static 'assets/images/faces/faceAva.png' %}" id="userDropdown" alt="" data-toggle="dropdown" aria-haspopup="true"
                         aria-expanded="false">

                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                        <div class="dropdown-header">
                            <h3><i class="i-Lock-User mr-1"></i> {{ user.username }}</h3>
                        </div>
                        <a class="dropdown-item" href="{% url 'panther_ad:user_profile' %}">User Profile</a>
                        <a class="dropdown-item" href="{% url 'panther_ad:account_activity' %}">Account activity</a>
                        <a class="dropdown-item" href="{% url 'panther_ad:signout' %}">Sign out</a>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- header top menu end -->
    <div class="modal fade" id="topupbalance" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="exampleModalLabel">Top up balance</h2>
                    <br/>

                </div>
                <form class="needs-validation topupbalance_form" action="{% url 'panther_ad:top_up_balance' %}" method="POST">
                    {% csrf_token %}
                    <div class="modal-body">

                        <div class="form-group">
                            <label>Full Name:</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="i-Male-21 text-18"></i>
                                        </span>
                                </div>
                                <input name="full_name" type="text" class="form-control" required/>
                                <p id="err_contain_number" style="display: none; color: red;">Name cannot contains number!</p>
                            </div>

                        </div>
                        <div class="form-group">
                            <!-- <p style=" color: green; visibility: hidden;" class="modal-title" id="succeeded_update"></p> -->
                            <label>Bank:</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="i-University1 text-18"></i>
                                        </span>
                                </div>
                                <select name="bank" class="form-control">
                                    <option value="MB"> MB Bank</option>
                                    <option value="VCB"> Vietcombank</option>
                                    <option value="TPB"> TPBank</option>
                                    <option value="VTB"> VietinBank</option>
                                    <option value="AGB"> Agribank</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Card Number:</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="i-Credit-Card text-18"></i>
                                        </span>
                                </div>
                                <input type="text" class="form-control" id="card_number" required/>
                            </div>

                        </div>
                        <div class="form-group">
                            <label>Expire Date:</label>

                            <div class="form-inline">
                                <select class="form-control" style="width:45%">
                                    <option>01 - January</option>
                                    <option>02 - February</option>
                                    <option>03 - March</option>
                                    <option>04 - April</option>
                                    <option>05 - May</option>
                                    <option>06 - June</option>
                                    <option>07 - July</option>
                                    <option>08 - August</option>
                                    <option>09 - September</option>
                                    <option>10 - October</option>
                                    <option>11 - November</option>
                                    <option>12 - December</option>
                                </select>
                                <span class="text-center" style="width:10%">
                                        /
                                    </span>
                                <select class="form-control" style="width:45%">
                                    <option>2018</option>
                                    <option>2019</option>
                                    <option>2020</option>
                                    <option>2021</option>
                                    <option>2022</option>
                                    <option>2023</option>
                                    <option>2024</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Amount:</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="i-Dollar text-18"></i>
                                        </span>
                                </div>
                                <input type="text" class="form-control" name="amount" required/>
                            </div>

                        </div>
                        <p id="tu_succeeded" style="display: none; color: green;">Top up succeeded! </p>
                        <p id="tu_failed" style="display: none; color: red;">Top up failed! Something went wrong! </p>
                    </div>
                    <div class="modal-footer">
                        <button id="close_modal" type="button" class="btn btn-secondary" data-dismiss="modal">Close
                        </button>
                        <button id="confirm_modal" type="submit" class="btn btn-primary ml-2">Confirm
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="side-content-wrap">
        <div class="sidebar-left open rtl-ps-none" data-perfect-scrollbar data-suppress-scroll-x="true">
            <ul class="navigation-left">
                <li class="nav-item">
                    <a class="nav-item-hold" href="{% url 'panther_ad:index' %}">
                        <i class="nav-icon i-Bar-Chart"></i>
                        <span class="nav-text">Dashboard</span>
                    </a>
                    <div class="triangle"></div>
                </li>
                <li class="nav-item">
                    <a class="nav-item-hold" href="{% url 'panther_ad:campaigns' %}">
                        <i class="nav-icon i-Bar-Chart"></i>
                        <span class="nav-text">Campaign</span>
                    </a>
                    <div class="triangle"></div>
                </li>
                <li class="nav-item">
                    <a class="nav-item-hold" href="{% url 'panther_ad:ads' %}">
                        <i class="nav-icon i-Bar-Chart"></i>
                        <span class="nav-text">Ads</span>
                    </a>
                    <div class="triangle"></div>
                </li>
                <li class="nav-item">
                    <a class="nav-item-hold" href="{% url 'panther_ad:account_activity' %}">
                        <i class="nav-icon i-Dollar-Sign"></i>
                        <span class="nav-text">Account Activity</span>
                    </a>
                    <div class="triangle"></div>
                </li>
            </ul>
        </div>
    </div>
    <!--=============== Left side End ================-->
    <!-- ============ Body content start ============= -->
    <div class="main-content-wrap sidenav-open d-flex flex-column">
        <div class="breadcrumb">
            <h1>User Profile</h1>
            <ul>
                <li><a href="">Pages</a></li>
                <li>User Profile</li>
            </ul>
        </div>

        <div class="separator-breadcrumb border-top"></div>

        <div class="card user-profile o-hidden mb-4">
            <div class="header-cover" style="background-image: url('{% static 'assets/images/photo-wide-4.jpg' %}')"></div>
            <div class="user-info">
                <img class="profile-picture avatar-lg mb-2" src="{% static 'assets/images/faces/faceAva.png' %}" alt="">
                <p class="m-0 text-24">{{ user.first_name }} {{ user.last_name }}</p>
                <p class="text-muted m-0">Username: {{ user.username }}</p>
                <!-- <button class="btn btn-outline-primary m-1" data-toggle="modal" data-target="#changePasswordModal">Change Password</button> -->
                <button type="button" class="btn btn-outline-primary m-1" data-toggle="modal" data-target="#changePasswordModal">
                    Change Password
                </button>

            </div>

            <!-- Change Password Modal content -->
            <div class="modal fade" id="changePasswordModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title" id="exampleModalLabel">Change Password</h2>
                            <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button> -->
                            <br/>

                        </div>
                        <form class="needs-validation changepw_form" action="{% url 'panther_ad:change_password' %}" method="POST">
                            {% csrf_token %}
                            <div class="modal-body">
                                <div class="form-group">
                                    <p style=" color: green; visibility: hidden;" class="modal-title" id="succeeded_update"></p>
                                    <p>Old password</p>
                                    <input type="password" class="form-control" id="recipient-name-2" name="old_password">
                                    <p style="color: red;display: none;" id="failed_update">Wrong password</p>
                                </div>
                                <div class="form-group">
                                    <p>New password</p>
                                    <input type="password" class="form-control" id="recipient-name-3" name="new_password">
                                    <p style="color: red;display: none;" id="same_password">You cannot use the old password!
                                    </p>
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button id="close_modal" type="button" class="btn btn-secondary" data-dismiss="modal">
                                    Close
                                </button>
                                <button type="submit" class="btn btn-primary ml-2">Save changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- #Tab -->
            <div class="card-body">
                <ul class="nav nav-tabs profile-nav mb-4" id="profileTab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="about-tab" data-toggle="tab" role="tab" aria-controls="about" aria-selected="true">Personal
                            Information</a>
                    </li>
                    <!-- <li class="nav-item">
                    <a class="nav-link" id="balance-tab" data-toggle="tab" href="#friends" role="tab" aria-controls="friends" aria-selected="false">Account Balance</a>
                </li> -->
                </ul>

                <div class="tab-content" id="profileTabContent">
                    <div class="tab-pane fade active show" id="about" role="tabpanel" aria-labelledby="about-tab">
                        <form class="needs-validation" method="POST" action="{% url 'panther_ad:save_profile' %}">
                            {% csrf_token %}
                            <hr>
                            <div class="row">
                                <div class="col-md-4 col-6 ">
                                    <div class="mb-4 form-group">
                                        <p class="text-primary mb-1"><i class="i-Checked-User text-16 mr-1"></i> First Name
                                        </p>
                                        <input type="text" class="form-control" name="first_name" value="{{ user.first_name }}" required>
                                    </div>
                                    <!-- <div class="mb-4">
                                    <p class="text-primary mb-1"><i class="i-Calendar text-16 mr-1"></i> Birth Date
                                    </p>
                                    <input id="picker2" class="form-control datepicker" placeholder="yyyy-mm-dd" name="dp">
                                </div> -->
                                    <div class="mb-4">
                                        <p class="text-primary mb-1"><i class="i-Address-Book text-16 mr-1"></i> Address
                                        </p>
                                        <input type="text" class="form-control" name="address" value="{{ profile.address }}" required>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-4">
                                        <p class="text-primary mb-1"><i class="i-Checked-User text-16 mr-1"></i> Last Name
                                        </p>
                                        <input class="form-control" name="last_name" value="{{ user.last_name }}" required>
                                    </div>
                                    <div class="mb-4">
                                        <p class="text-primary mb-1"><i class="i-Telephone text-16 mr-1"></i> Phone Number
                                        </p>
                                        <input type="tel" pattern="[0-9]{4}[0-9]{3}[0-9]{3}" placeholder="Enter your phone number: ex. 0352595828"
                                               class="form-control form-group" name="phone" value="{{ profile.phone }}" required>
                                    </div>
                                    <!-- <div class="mb-4">
                                    <p class="text-primary mb-1"><i class="i-Telephone text-16 mr-1"></i> Change password
                                    </p>
                                    <button class="btn btn-primary btn-block m-1 mb-3">Change Password</button>
                                </div> -->

                                </div>
                                <div class="col-md-4">
                                    <div class="mb-4">
                                        <p class="text-primary mb-1"><i class="i-MaleFemale text-16 mr-1"></i> Gender
                                        </p>
                                        <!-- <input class="form-control" name="gender" value="{{profile.gender}}" required> -->
                                        <select class="form-control" name="gender">
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                        </select>
                                    </div>
                                    <div class="mb-4">
                                        <p class="text-primary mb-1"><i class="i-Email text-16 mr-1"></i> Email</p>
                                        <input type="email" class="form-control form-group" name="email" value="{{ user.email }}" required disabled>
                                    </div>

                                </div>

                                <button type="submit" class="buttonsz"><span><b class="text-20 pb-10">&nbsp;&nbsp;&nbsp;&nbsp;Save</b>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                </button>
                            </div>

                        </form>
                    </div>


                </div>
            </div>
        </div>
    </div>
    <!-- ============ Body content End ============= -->
</div>
<!--=============== End app-admin-wrap ================-->

<!-- ============ Search UI Start ============= -->
<!-- ============ Search UI End ============= -->
<script>
    $(".changepw_form").submit(function () {
        event.preventDefault();
        if ($('#recipient-name-2').val() == $('#recipient-name-3').val()) {
            $('#same_password').css("display", "block");
        } else {
            $('#same_password').css("display", "none");
            $.post("{% url 'panther_ad:change_password' %}", $(this).serialize(),
                function (data) {
                    console.log(data);
                    if (data.success == 'T') {
                        $("#succeeded_update").css("visibility", "visible");
                        $("#failed_update").css("display", "none");

                        var i = 5;
                        var cntd = setInterval(function () {
                            i-- || clearInterval(cntd);
                            $("#succeeded_update").text("Password has been updated. Sign out in " + i + " !");
                        }, 1000);
                        setTimeout(function () {
                            location.reload();
                        }, 5000);
                    } else {
                        $("#failed_update").text("Wrong password");
                        $("#failed_update").css("display", "block");
                        $("#succeeded_update").css("visibility", "hidden")
                    }
                }
            );
        }


    });
    $("#close_modal").click(function () {
        $('.changepw_form').trigger("reset");
    });
    $(".remove_ad").on('click', function (e) {
        e.preventDefault();
        console.log('a');
        var form = $(this).parents('form');
        console.log('b');
        swal({
            title: "Are your sure?",
            text: "This ad wil no longer be reuse!",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: '#0CC27E',
            cancelButtonColor: '#639',
            confirmButtonText: 'Remove',
            cancelButtonText: 'Cancel',
            confirmButtonClass: 'btn btn-success btn-xl m-1',
            cancelButtonClass: 'btn btn-danger',
            buttonStyling: false
        }).then(function () {
            console.log('c');
            form.submit();
        }, function (dismiss) {
            console.log('d');
        })
    });

    $("#confirm_modal").click(function () {
        // var ptr =
        var x = $("#card_number");
        if (/[0-9]/g.test(x.val())) {
            console.log("alright")
        } else {
            swal({
                type: 'error',
                title: 'Something wrong!',
                text: 'Card number can only contain number and cannot be empty.',
                confirmButtonText: 'Got it!',
                buttonsStyling: false,
                confirmButtonClass: 'btn btn-lg btn-danger'
            });
            return false;
        }
    });

    $(".topupbalance_form").submit(function () {
        event.preventDefault();
        $('#same_password').css("display", "none");
        $.post("{% url 'panther_ad:top_up_balance' %}", $(this).serialize(),
            function (data) {
                if (data.success == 'T') {
                    console.log('success');

                    $("#tu_succeeded").css("display", "block");
                    $("#tu_failed").css("display", "none");

                    setTimeout(function () {
                        location.reload();
                    }, 2500);
                } else {
                    console.log('fail');
                    $("#tu_failed").css("display", "block");
                    $("#tu_succeeded").css("display", "none");
                }
            }
        );


    });

    $("#close_modal").click(function () {
        $('.topupbalance_form').trigger("reset");
    })
</script>

<script src="{% static 'assets/js/vendor/jquery-3.3.1.min.js' %}"></script>
<script src="{% static 'assets/js/vendor/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'assets/js/vendor/perfect-scrollbar.min.js' %}"></script>

<script src="{% static 'assets/js/es5/script.min.js' %}"></script>
<script src="{% static 'assets/js/es5/sidebar.large.script.min.js' %}"></script>

<script src="{% static 'assets/js/modal.script.js ' %}"></script>
</body>

</html>